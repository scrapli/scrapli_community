<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.4" />
<title>scrapli_community.mikrotik.routeros.sync API documentation</title>
<meta name="description" content="scrapli_community.mikrotik.routeros.sync" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>scrapli_community.mikrotik.routeros.sync</code></h1>
</header>
<section id="section-intro">
<p>scrapli_community.mikrotik.routeros.sync</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;scrapli_community.mikrotik.routeros.sync&#34;&#34;&#34;
from typing import Any, List, Optional, Union

from scrapli.driver import GenericDriver
from scrapli.response import Response


def default_sync_on_close(conn: GenericDriver) -&gt; None:
    &#34;&#34;&#34;
    mikrotik_routeros default on_close callable

    Args:
        conn: NetworkDriver object

    Returns:
        N/A  # noqa: DAR202

    Raises:
        N/A
    &#34;&#34;&#34;
    # write exit directly to the transport as channel would fail to find the prompt after sending
    # the exit command!
    conn.transport.write(channel_input=&#34;/quit&#34;)
    conn.transport.write(channel_input=conn.channel.comms_return_char)


class MikrotikRouterOSDriver(GenericDriver):
    def __init__(self, *args: Any, **kwargs: Any) -&gt; None:
        &#34;&#34;&#34;
        Mikrotik RouterOS platform class

        Args:
            args: positional args
            kwargs: keyword args

        Returns:
            N/A  # noqa: DAR202

        Raises:
            N/A

        &#34;&#34;&#34;

        # Append login options to the username according to
        # https://wiki.mikrotik.com/wiki/Manual:Console_login_process
        kwargs[&#34;auth_username&#34;] += &#34;+cet511w4098h&#34;

        super().__init__(*args, **kwargs)

    def send_command(
        self,
        command: str,
        strip_prompt: bool = True,
        failed_when_contains: Optional[Union[str, List[str]]] = None,
        *,
        timeout_ops: Optional[float] = None,
    ) -&gt; Response:
        &#34;&#34;&#34;
        mikrotik_routeros send_command method

        Args:
            command: string to send to device in privilege exec mode
            strip_prompt: True/False strip prompt from returned output
            failed_when_contains: string or list of strings indicating failure if found in response
            timeout_ops: timeout ops value for this operation; only sets the timeout_ops value for
                the duration of the operation, value is reset to initial value after operation is
                completed

        Returns:
            Response: Scrapli Response object

        Raises:
            N/A

        &#34;&#34;&#34;

        # RouterOS echoes the prompt/pattern twice after sending a command,
        # modify the prompt pattern accordingly to catch both echoes.
        #
        # [user@HOSTNAME]&gt; /command\r\n[user@HOSTNAME]&gt; /command\r\nOUTPUT...
        #
        old_comms_prompt_pattern = self.channel.comms_prompt_pattern
        self.channel.comms_prompt_pattern = (
            f&#34;{old_comms_prompt_pattern}.*{old_comms_prompt_pattern}&#34;
        )

        response = super().send_command(
            command, strip_prompt, failed_when_contains, timeout_ops=timeout_ops
        )

        # Change the prompt pattern back to the original one.
        self.channel.comms_prompt_pattern = old_comms_prompt_pattern

        # Since the command is echoed twice, and scrapli only removes it once, we need to
        # manually remove the second command echo by stripping the first line from the output.
        if response.result.count(&#34;\n&#34;) &gt; 0 and command in response.result.split(&#34;\n&#34;)[0]:
            response.result = &#34;\n&#34;.join(response.result.split(&#34;\n&#34;)[1:])

        return response</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="scrapli_community.mikrotik.routeros.sync.default_sync_on_close"><code class="name flex">
<span>def <span class="ident">default_sync_on_close</span></span>(<span>conn: scrapli.driver.generic_driver.GenericDriver) ‑> NoneType</span>
</code></dt>
<dd>
<div class="desc"><p>mikrotik_routeros default on_close callable</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>conn</code></strong></dt>
<dd>NetworkDriver object</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>N/A
# noqa: DAR202</p>
<h2 id="raises">Raises</h2>
<p>N/A</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def default_sync_on_close(conn: GenericDriver) -&gt; None:
    &#34;&#34;&#34;
    mikrotik_routeros default on_close callable

    Args:
        conn: NetworkDriver object

    Returns:
        N/A  # noqa: DAR202

    Raises:
        N/A
    &#34;&#34;&#34;
    # write exit directly to the transport as channel would fail to find the prompt after sending
    # the exit command!
    conn.transport.write(channel_input=&#34;/quit&#34;)
    conn.transport.write(channel_input=conn.channel.comms_return_char)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="scrapli_community.mikrotik.routeros.sync.MikrotikRouterOSDriver"><code class="flex name class">
<span>class <span class="ident">MikrotikRouterOSDriver</span></span>
<span>(</span><span>*args: Any, **kwargs: Any)</span>
</code></dt>
<dd>
<div class="desc"><p>GenericDriverBase Object</p>
<p>A generic network driver that will <em>hopefully</em> work for a broad variety of devices with
minimal to no modifications and provide a normal NetworkDriver type experience with
<code>send_command(s)</code>, <code>get_prompt</code> and <code>send_interactive</code> methods instead of forcing users to
call Channel methods directly.</p>
<p>This driver doesn't know anything about privilege levels (or any type of "config modes",
disabling paging, gracefully exiting, or anything like that, and as such should be treated
similar to the base <code>Scrape</code> object from that perspective.</p>
<p>Mikrotik RouterOS platform class</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>args</code></strong></dt>
<dd>positional args</dd>
<dt><strong><code>kwargs</code></strong></dt>
<dd>keyword args</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>N/A
# noqa: DAR202</p>
<h2 id="raises">Raises</h2>
<p>N/A</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MikrotikRouterOSDriver(GenericDriver):
    def __init__(self, *args: Any, **kwargs: Any) -&gt; None:
        &#34;&#34;&#34;
        Mikrotik RouterOS platform class

        Args:
            args: positional args
            kwargs: keyword args

        Returns:
            N/A  # noqa: DAR202

        Raises:
            N/A

        &#34;&#34;&#34;

        # Append login options to the username according to
        # https://wiki.mikrotik.com/wiki/Manual:Console_login_process
        kwargs[&#34;auth_username&#34;] += &#34;+cet511w4098h&#34;

        super().__init__(*args, **kwargs)

    def send_command(
        self,
        command: str,
        strip_prompt: bool = True,
        failed_when_contains: Optional[Union[str, List[str]]] = None,
        *,
        timeout_ops: Optional[float] = None,
    ) -&gt; Response:
        &#34;&#34;&#34;
        mikrotik_routeros send_command method

        Args:
            command: string to send to device in privilege exec mode
            strip_prompt: True/False strip prompt from returned output
            failed_when_contains: string or list of strings indicating failure if found in response
            timeout_ops: timeout ops value for this operation; only sets the timeout_ops value for
                the duration of the operation, value is reset to initial value after operation is
                completed

        Returns:
            Response: Scrapli Response object

        Raises:
            N/A

        &#34;&#34;&#34;

        # RouterOS echoes the prompt/pattern twice after sending a command,
        # modify the prompt pattern accordingly to catch both echoes.
        #
        # [user@HOSTNAME]&gt; /command\r\n[user@HOSTNAME]&gt; /command\r\nOUTPUT...
        #
        old_comms_prompt_pattern = self.channel.comms_prompt_pattern
        self.channel.comms_prompt_pattern = (
            f&#34;{old_comms_prompt_pattern}.*{old_comms_prompt_pattern}&#34;
        )

        response = super().send_command(
            command, strip_prompt, failed_when_contains, timeout_ops=timeout_ops
        )

        # Change the prompt pattern back to the original one.
        self.channel.comms_prompt_pattern = old_comms_prompt_pattern

        # Since the command is echoed twice, and scrapli only removes it once, we need to
        # manually remove the second command echo by stripping the first line from the output.
        if response.result.count(&#34;\n&#34;) &gt; 0 and command in response.result.split(&#34;\n&#34;)[0]:
            response.result = &#34;\n&#34;.join(response.result.split(&#34;\n&#34;)[1:])

        return response</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>scrapli.driver.generic_driver.GenericDriver</li>
<li>scrapli.driver.driver.Scrape</li>
<li>scrapli.driver.base_driver.ScrapeBase</li>
<li>scrapli.driver.base_generic_driver.GenericDriverBase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="scrapli_community.mikrotik.routeros.sync.MikrotikRouterOSDriver.send_command"><code class="name flex">
<span>def <span class="ident">send_command</span></span>(<span>self, command: str, strip_prompt: bool = True, failed_when_contains: Union[str, List[str], NoneType] = None, *, timeout_ops: Union[float, NoneType] = None) ‑> scrapli.response.Response</span>
</code></dt>
<dd>
<div class="desc"><p>mikrotik_routeros send_command method</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>command</code></strong></dt>
<dd>string to send to device in privilege exec mode</dd>
<dt><strong><code>strip_prompt</code></strong></dt>
<dd>True/False strip prompt from returned output</dd>
<dt><strong><code>failed_when_contains</code></strong></dt>
<dd>string or list of strings indicating failure if found in response</dd>
<dt><strong><code>timeout_ops</code></strong></dt>
<dd>timeout ops value for this operation; only sets the timeout_ops value for
the duration of the operation, value is reset to initial value after operation is
completed</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Response</code></dt>
<dd>Scrapli Response object</dd>
</dl>
<h2 id="raises">Raises</h2>
<p>N/A</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def send_command(
    self,
    command: str,
    strip_prompt: bool = True,
    failed_when_contains: Optional[Union[str, List[str]]] = None,
    *,
    timeout_ops: Optional[float] = None,
) -&gt; Response:
    &#34;&#34;&#34;
    mikrotik_routeros send_command method

    Args:
        command: string to send to device in privilege exec mode
        strip_prompt: True/False strip prompt from returned output
        failed_when_contains: string or list of strings indicating failure if found in response
        timeout_ops: timeout ops value for this operation; only sets the timeout_ops value for
            the duration of the operation, value is reset to initial value after operation is
            completed

    Returns:
        Response: Scrapli Response object

    Raises:
        N/A

    &#34;&#34;&#34;

    # RouterOS echoes the prompt/pattern twice after sending a command,
    # modify the prompt pattern accordingly to catch both echoes.
    #
    # [user@HOSTNAME]&gt; /command\r\n[user@HOSTNAME]&gt; /command\r\nOUTPUT...
    #
    old_comms_prompt_pattern = self.channel.comms_prompt_pattern
    self.channel.comms_prompt_pattern = (
        f&#34;{old_comms_prompt_pattern}.*{old_comms_prompt_pattern}&#34;
    )

    response = super().send_command(
        command, strip_prompt, failed_when_contains, timeout_ops=timeout_ops
    )

    # Change the prompt pattern back to the original one.
    self.channel.comms_prompt_pattern = old_comms_prompt_pattern

    # Since the command is echoed twice, and scrapli only removes it once, we need to
    # manually remove the second command echo by stripping the first line from the output.
    if response.result.count(&#34;\n&#34;) &gt; 0 and command in response.result.split(&#34;\n&#34;)[0]:
        response.result = &#34;\n&#34;.join(response.result.split(&#34;\n&#34;)[1:])

    return response</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="scrapli_community.mikrotik.routeros" href="index.html">scrapli_community.mikrotik.routeros</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="scrapli_community.mikrotik.routeros.sync.default_sync_on_close" href="#scrapli_community.mikrotik.routeros.sync.default_sync_on_close">default_sync_on_close</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="scrapli_community.mikrotik.routeros.sync.MikrotikRouterOSDriver" href="#scrapli_community.mikrotik.routeros.sync.MikrotikRouterOSDriver">MikrotikRouterOSDriver</a></code></h4>
<ul class="">
<li><code><a title="scrapli_community.mikrotik.routeros.sync.MikrotikRouterOSDriver.send_command" href="#scrapli_community.mikrotik.routeros.sync.MikrotikRouterOSDriver.send_command">send_command</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.4</a>.</p>
</footer>
</body>
</html>